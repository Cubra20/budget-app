<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="manifest" href="manifest.json">
<title>Budget App</title>
<style>
body{font-family:Arial;background:#f4f6f8;padding:20px}
.dark{background:#121212;color:#fff}
.card{background:#fff;padding:15px;border-radius:12px;margin-bottom:15px}
.dark .card{background:#1e1e1e}
button{padding:8px;margin:4px}
</style>
</head>

<body>
<h2>Budget App</h2>
<button onclick="toggle()">ðŸŒ™</button>

<div class="card">
<input type="date" id="date">
<input placeholder="Category" id="cat">
<input placeholder="Description" id="desc">
<input type="number" id="amt">
<select id="type">
<option>Income</option>
<option>Expense</option>
</select>
<button onclick="add()">Save</button>
</div>

<div class="card">
<table id="list"></table>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbyVSBcFx68gzPWg0UzaErjWuz7fYvJAZdyDsfpnRlm70j-5mnorb7jFk6QtLqBlUhKZdg/exec";

function toggle(){
  document.body.classList.toggle("dark");
  localStorage.theme=document.body.classList.contains("dark")?"dark":"light";
}

document.body.classList.toggle("dark",localStorage.theme==="dark");

function add(){
  fetch(API+"?action=add",{method:"POST",
    body:JSON.stringify({
      date:date.value,
      category:cat.value,
      description:desc.value,
      amount:amt.value,
      type:type.value
    })
  }).then(load);
}

function load(){
  fetch(API+"?action=list",{method:"POST"})
    .then(r=>r.json())
    .then(d=>{
      list.innerHTML=d.map(r=>`
        <tr>
          <td>${r[2]}</td>
          <td>${r[4]}</td>
          <td><button onclick="del('${r[0]}')">ðŸ—‘</button></td>
        </tr>
      `).join("");
    });
}

function del(id){
  fetch(API+"?action=delete",{method:"POST",
    body:JSON.stringify({id})
  }).then(load);
}

load();
</script>
<script>
if("serviceWorker" in navigator){
  navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
